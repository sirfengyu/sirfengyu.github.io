(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{608:function(e,s,n){"use strict";n.r(s);var a=n(10),t=Object(a.a)({},(function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"groovy-应用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#groovy-应用"}},[e._v("#")]),e._v(" groovy 应用")]),e._v(" "),n("h2",{attrs:{id:"_1-取出json中某个字段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-取出json中某个字段"}},[e._v("#")]),e._v(" 1. 取出json中某个字段")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('import groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\n\nString res = \'{"code":"0000","codeDescription":"成功","toastMessage":"成功","caseList":[{"caseNumber":"EC00014EF","caseStates":"待接收"},{"caseNumber":"EC00014SE","caseStates":"新创建"},{"caseNumber":"EC00014S7","caseStates":"处理中"},{"caseNumber":"EC00014S6","caseStates":"处理中"},{"caseNumber":"EC00014S5","caseStates":"处理中"},{"caseNumber":"EC00014S4","caseStates":"处理中"},{"caseNumber":"EC00014S3","caseStates":"处理中"},{"caseNumber":"EC00014RW","caseStates":"处理中"},{"caseNumber":"EC00014RV","caseStates":"处理中"}],"pageSize":10,"ResponseCode":"8000001","ResponseCodeDescription":"成功","StandardQueryID":null,"QueryTime":null}\'\n// String res = prev.getResponseDataAsString()\n\n\ndef jsonStr = new JsonSlurper().parseText(res)\n// jsonStr[\'caseList\'].each{ item ->\n// \tif (item[\'caseStates\'] == \'新创建\'){\n// \t\tprint item[\'caseNumber\']\n// \t}\n// }\n\n\nprint jsonStr[\'caseList\'].findAll{item -> item[\'caseStates\'] == \'新创建\'}[0][\'caseNumber\']\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br")])]),n("h2",{attrs:{id:"_2-groovy-发送http请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-groovy-发送http请求"}},[e._v("#")]),e._v(" 2. groovy 发送http请求")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('import groovy.json.JsonOutput\nimport groovy.json.JsonSlurper\n\ndef jsonMap = [:]\ndef markLoans = new URL("http://10.1.5.215:8080/api/contracts/"+ contractNo +"/mark-loans/").openConnection();\ndef markLoansMap = [:]\nmarkLoansMap.put("loanDate",repayDay+"T16:15:00.000+0800")\nmarkLoansMap.put("loanResults","SUCCESS")\nmarkLoansMap.put("paymentNo",paymentNo)\ndef markLoansMessage = JsonOutput.toJson(markLoansMap)\nlog.info(markLoansMessage)\nmarkLoans.setRequestMethod("POST")\nmarkLoans.setDoOutput(true)\nmarkLoans.setRequestProperty("Content-Type", "application/json")\nmarkLoans.getOutputStream().write(markLoansMessage.getBytes("UTF-8"));\ndef markLoansRC = markLoans.getResponseCode();\ndef markLoansData\nlog.info("markLoansRC:"+markLoansRC);\nif(markLoansRC.equals(200)) {\n    markLoansData=markLoans.getInputStream().getText();\n}\nlog.info("markLoansData:"+markLoansData)\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br")])]),n("h2",{attrs:{id:"_3-groovy-执行sql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-groovy-执行sql"}},[e._v("#")]),e._v(" "),n("a",{attrs:{href:"https://fengyu.ink/resources/groovy.html#_3-groovy-%E6%89%A7%E8%A1%8Csql",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1),e._v("3. groovy 执行sql")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('import groovy.sql.Sql\n\ndef krdburl="jdbc:mysql://krtestdb01.c1gls1uyilgy.rds.cn-northwest-1.amazonaws.com.cn:3306/"\ndef username="fengyu"\ndef password="e1e29c84ea7"\ndef driverClass="com.mysql.jdbc.Driver"\ndef sql = Sql.newInstance(krdburl, username, password, driverClass)\n\n\ndef CID\nsql.eachRow("select * from cifdb.t_customer_base where mobile_phone in (\'${phone}\')") { row ->\n//        println(row.id)\n        CID = row.id\n    }\nprintln CID\n\n//sql.connection.autoCommit = false\nsql.execute("delete from cifdb.t_customer_base where mobile_phone = \'${phone}\'")\n\ndef del = "delete from cifdb.t_customer_partner where cid = \'"+CID+"\'"\nsql.execute(del)\ndef del1 = "delete from oidc.user_partner_bind where cif_user_id = \'"+CID+"\'"\nsql.execute(del1)\ndef del2 = "delete from credit.t_partner_data_record  where cid = \'"+CID+"\'"\nsql.execute(del2)\ndef del3 = "delete from pbank.t_rpt_action_log where out_biz_id = (select t1.out_biz_id from pbank.t_rpt_base_info_anlyz t1 where t1.cid= \'"+CID+"\')"\nsql.execute(del3)\ndef del4 = "delete from pbank.t_rpt_base_info_anlyz where cid = \'"+CID+"\'"\nsql.execute(del4)\ndef del5 = "delete from cifdb.t_customer_card where cid in (select id from cifdb.t_customer_base where id =\'"+CID+"\')"\ndef del6 = "delete from cifdb.t_customer_trankeyword where cid in (select id from cifdb.t_customer_base where id =\'"+CID+"\')"\ndef del7 = "delete from cifdb.t_customer_posekeyword where cid in (select id from cifdb.t_customer_base where id =\'"+CID+"\')"\ndef del8 = "delete from cifdb.t_customer_base where id =\'"+CID+"\'"\ndef del9 = "delete from cifdb.t_customer_base_log where baseid =\'"+CID+"\'"\ndef del10 = "delete from cifdb.t_customer_linkman where cid =\'"+CID+"\'"\ndef del11 = "delete from cifdb.t_customer_linkman_log where cid =\'"+CID+"\'"\ndef del12 = "delete from accountdb.t_account_base where cid =\'"+CID+"\'"\ndef del13 = "delete from cifdb.t_customer_lbs where cid =\'"+CID+"\'"\ndef del14 = "delete from cifdb.t_customer_lbs_log where cid =\'"+CID+"\'"\ndef del15 = "delete from cifdb.t_customer_address where cid =\'"+CID+"\'"\ndef del16 = "delete from cifdb.t_customer_address_log where cid =\'"+CID+"\'"\ndef del17 = "delete from oidc.user_login_log where phone_num= \'${phone}\'"\ndef del18 = "delete from cifdb.t_customer_credentials where idcard_no= \'${credentials}\'"\ndef del19 = "delete from cifdb.t_customer_credentials_log where idcard_no= \'${credentials}\'"\ndef del20 = "delete from cifdb.t_customer_base_log where identity_no= \'${credentials}\'"\nsql.execute(del5)\nsql.execute(del6)\nsql.execute(del7)\nsql.execute(del8)\nsql.execute(del9)\nsql.execute(del10)\nsql.execute(del11)\nsql.execute(del12)\nsql.execute(del13)\nsql.execute(del14)\nsql.execute(del15)\nsql.execute(del16)\nsql.execute(del17)\nsql.execute(del18)\nsql.execute(del19)\nsql.execute(del20)\n\nsql.close()\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br"),n("span",{staticClass:"line-number"},[e._v("29")]),n("br"),n("span",{staticClass:"line-number"},[e._v("30")]),n("br"),n("span",{staticClass:"line-number"},[e._v("31")]),n("br"),n("span",{staticClass:"line-number"},[e._v("32")]),n("br"),n("span",{staticClass:"line-number"},[e._v("33")]),n("br"),n("span",{staticClass:"line-number"},[e._v("34")]),n("br"),n("span",{staticClass:"line-number"},[e._v("35")]),n("br"),n("span",{staticClass:"line-number"},[e._v("36")]),n("br"),n("span",{staticClass:"line-number"},[e._v("37")]),n("br"),n("span",{staticClass:"line-number"},[e._v("38")]),n("br"),n("span",{staticClass:"line-number"},[e._v("39")]),n("br"),n("span",{staticClass:"line-number"},[e._v("40")]),n("br"),n("span",{staticClass:"line-number"},[e._v("41")]),n("br"),n("span",{staticClass:"line-number"},[e._v("42")]),n("br"),n("span",{staticClass:"line-number"},[e._v("43")]),n("br"),n("span",{staticClass:"line-number"},[e._v("44")]),n("br"),n("span",{staticClass:"line-number"},[e._v("45")]),n("br"),n("span",{staticClass:"line-number"},[e._v("46")]),n("br"),n("span",{staticClass:"line-number"},[e._v("47")]),n("br"),n("span",{staticClass:"line-number"},[e._v("48")]),n("br"),n("span",{staticClass:"line-number"},[e._v("49")]),n("br"),n("span",{staticClass:"line-number"},[e._v("50")]),n("br"),n("span",{staticClass:"line-number"},[e._v("51")]),n("br"),n("span",{staticClass:"line-number"},[e._v("52")]),n("br"),n("span",{staticClass:"line-number"},[e._v("53")]),n("br"),n("span",{staticClass:"line-number"},[e._v("54")]),n("br"),n("span",{staticClass:"line-number"},[e._v("55")]),n("br"),n("span",{staticClass:"line-number"},[e._v("56")]),n("br"),n("span",{staticClass:"line-number"},[e._v("57")]),n("br"),n("span",{staticClass:"line-number"},[e._v("58")]),n("br"),n("span",{staticClass:"line-number"},[e._v("59")]),n("br"),n("span",{staticClass:"line-number"},[e._v("60")]),n("br"),n("span",{staticClass:"line-number"},[e._v("61")]),n("br"),n("span",{staticClass:"line-number"},[e._v("62")]),n("br"),n("span",{staticClass:"line-number"},[e._v("63")]),n("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);