(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{592:function(s,n,a){"use strict";a.r(n);var t=a(10),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"四、mock与axios实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、mock与axios实战"}},[s._v("#")]),s._v(" 四、mock与axios实战")]),s._v(" "),a("h2",{attrs:{id:"依赖包安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#依赖包安装"}},[s._v("#")]),s._v(" 依赖包安装")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cnpm install mockjs axios\ncnpm install axios-mock-adapter --save-dev\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"新增src-mock-data-todolist-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新增src-mock-data-todolist-js"}},[s._v("#")]),s._v(" 新增src/mock/data/todoList.js")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import Mock from 'mockjs'; // 导入mockjs 模块\nlet Todos = []; // 定义我们需要的数据\nconst COUNT = [1, 2, 3, 4, 5]; // 定义我们需要数量\nfor (let i = 1; i <= COUNT.length; i++) { Todos.push(Mock.mock({ // 根据数据模板生成模拟数据。 id: Mock.Random.guid(), // 随机id title: Mock.Random.first(), // 随机标题 isDelete: false, //是否删除 locked: Mock.Random.boolean(), // 随机锁定 record: COUNT.map(() => { // 代办单项列表的数据\n            return {\n                text: Mock.Random.cparagraph(2), // 随机内容\n                isDelete: false, //是否删除\n                checked: Mock.Random.boolean()  //是否完成\n            };\n        })\n    }));\n}\nexport { // 导出列表数据\n    Todos\n};\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"新增src-mock-mock-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新增src-mock-mock-js"}},[s._v("#")]),s._v(" 新增src/mock/mock.js")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import axios from 'axios';\nimport MockAdapter from 'axios-mock-adapter';\nimport Mock from 'mockjs';\nimport {\n    Todos\n} from './data/todoList'; // 导入Todos数据\nexport default {\n    /**\n     * mock start\n     */\n    start() { // 初始化函数\n        let mock = new MockAdapter(axios); // 创建 MockAdapter 实例\n        // 获取todo列表\n        mock.onGet('/todo/list').reply(config => { //  config 指 前台传过来的值\n            let mockTodo = Todos.map(tode => { // 重组 Todos数组，变成我们想要的数据\n                return {\n                    id: tode.id,\n                    title: tode.title,\n                    count: tode.record.filter((data) => {\n                        if (data.checked === false) return true;\n                        return false;\n                    }).length, // 过滤到record里面 ‘checked’ 为true的数据，因为它们已经被完成了\n                    locked: tode.locked,\n                    isDelete: tode.isDelete\n                };\n            }).filter(tode => {\n                if (tode.isDelete === true) return false; // 过滤掉 ‘isDelete’为true，因为已经被删除了。\n                return true;\n            });\n            return new Promise((resolve, reject) => {\n                setTimeout(() => {\n                    resolve([200, {\n                        todos: mockTodo // 返回状态为200，并且返回todos数据\n                    }]);\n                }, 200);\n            });\n        });\n        // 新增一条todo\n        mock.onPost('/todo/addTodo').reply(config => {\n            Todos.push({\n                id: Mock.Random.guid(),\n                title: 'newList',\n                isDelete: false,\n                locked: false,\n                record: []\n            });\n            return new Promise((resolve, reject) => {\n                setTimeout(() => {\n                    resolve([200]);\n                }, 200);\n            });\n        });\n    }\n};\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br")])]),a("h2",{attrs:{id:"新增src-mock-index-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新增src-mock-index-js"}},[s._v("#")]),s._v(" 新增src/mock/index.js")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import mock from './mock';\nexport default mock; // 导入同级下mock.js的内容，并且导出\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"新增main-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新增main-js"}},[s._v("#")]),s._v(" 新增main.js")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import Mock from './mock'; // 引入mock模块\nMock.start(); //并且执行初始化函数\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"新增src-api-api-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新增src-api-api-js"}},[s._v("#")]),s._v(" 新增src/api/api.js")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import axios from 'axios'; //导入axios模块\nexport const getTodoList = params => { //封装一个函数，名为getTodoList\n    return axios.get(`/todo/list`, { // 请求路径 ‘/todo/list’\n        params: params\n    });\n};\nexport const addTodo = params => {\n    return axios.post(`/todo/addTodo`, params).then(res => res.data);\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"修改src-components-menus-vue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改src-components-menus-vue"}},[s._v("#")]),s._v(" 修改src/components/menus.vue")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('<template>\n    <div class="list-todos">\n        \x3c!--菜单容器--\x3e\n        <a v-on:click="goList(item.id)" class="list-todo activeListClass list" v-bind:class="{\'active\': item.id === todoId}" v-for="item in items" v-bind:key="item.index">\n            \x3c!--单个菜单容器--\x3e\n            <span class="icon-lock" v-if="item.locked"></span>\n            \x3c!-- v-if 条件渲染--\x3e\n            <span class="count-list" v-if="item.count> 0"> {{item.count}} </span> {{item.title}}\n            \x3c!-- 数据绑定，看模板语法--\x3e\n        </a>\n        <a class=" link-list-new">\n            \x3c!--新增菜单--\x3e\n            <span class="icon-plus">\n                    </span> 新增\n        </a>\n    </div>\n</template>\n\n\n<script>\n    import {\n        getTodoList,\n        addTodo\n    } from \'../api/api\'; // 引入我们 封装好的两个接口函数。\n    export default {\n        data() {\n            return {\n                items: [], // 菜单数据\n                todoId: \'\' // 默认选中id\n            };\n        },\n        created() { // 调用请求菜单列表数据的接口\n            getTodoList({}).then(res => {\n                const TODOS = res.data.todos; // 数据都会返回在res.data里面。\n                this.items = TODOS; // 我的把菜单数据赋值给定义的this.items\n                this.todoId = TODOS[0].id; // 把菜单数据的默认的第一个对象的id赋值给默认选中的id\n            });\n        },\n        methods: {\n            goList(id) { // 点击菜单时候,替换选中id\n                this.todoId = id;\n            },\n            addTodoList() { // 点击新增按钮时候\n                // 调用新增菜单的接口，在接口调用成功在请求数据\n                addTodo({}).then(data => {\n                    getTodoList({}).then(res => {\n                        const TODOS = res.data.todos;\n                        this.todoId = TODOS[TODOS.length - 1].id;\n                        this.items = TODOS;\n                    });\n                });\n            }\n        }\n    };\n<\/script>\n\n<style lang="less">\n    @import \'../assets/style/menu.less\';\n</style>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);