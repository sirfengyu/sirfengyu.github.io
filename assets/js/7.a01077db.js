(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{549:function(n,s,a){n.exports=a.p+"assets/img/20190418101720372_945581459.23725830.png"},550:function(n,s,a){n.exports=a.p+"assets/img/20190418101739177_1008593613.d88ea567.png"},551:function(n,s,a){n.exports=a.p+"assets/img/20190418101805996_1344427920.2c6c5741.png"},552:function(n,s,a){n.exports=a.p+"assets/img/20190418101825701_2124601353.e2d9c402.png"},553:function(n,s,a){n.exports=a.p+"assets/img/20190418101844272_1964341202.8fa90cee.png"},554:function(n,s,a){n.exports=a.p+"assets/img/20190418101903285_1416476683.bd528196.png"},555:function(n,s,a){n.exports=a.p+"assets/img/20190418101927833_1867384186.2fc25e1c.png"},556:function(n,s,a){n.exports=a.p+"assets/img/20190418101946536_1799996844.af9898d6.png"},557:function(n,s,a){n.exports=a.p+"assets/img/20190418102000608_944821819.21991644.png"},558:function(n,s,a){n.exports=a.p+"assets/img/20190418102018159_1126226015.28b42465.png"},559:function(n,s,a){n.exports=a.p+"assets/img/20190418110332125_772260957.478cb33a.png"},607:function(n,s,a){"use strict";a.r(s);var t=a(10),e=Object(t.a)({},(function(){var n=this,s=n.$createElement,t=n._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h1",{attrs:{id:"jmeter压测rabbitmq的脚本准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jmeter压测rabbitmq的脚本准备"}},[n._v("#")]),n._v(" jmeter压测rabbitmq的脚本准备")]),n._v(" "),t("h2",{attrs:{id:"基于springboot生产、消费消息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基于springboot生产、消费消息"}},[n._v("#")]),n._v(" 基于springboot生产、消费消息")]),n._v(" "),t("h3",{attrs:{id:"代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[n._v("#")]),n._v(" 代码")]),n._v(" "),t("p",[n._v("新建maven工程\npom.xml")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.</groupId>\n    <artifactId>rabbitmq-producer</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.0.RELEASE</version>\n    </parent>\n    \n\n\n    <dependencies>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-autoconfigure</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-amqp</artifactId>\n        </dependency>\n\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <configuration>\n                    <fork>true</fork>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n')])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br"),t("span",{staticClass:"line-number"},[n._v("13")]),t("br"),t("span",{staticClass:"line-number"},[n._v("14")]),t("br"),t("span",{staticClass:"line-number"},[n._v("15")]),t("br"),t("span",{staticClass:"line-number"},[n._v("16")]),t("br"),t("span",{staticClass:"line-number"},[n._v("17")]),t("br"),t("span",{staticClass:"line-number"},[n._v("18")]),t("br"),t("span",{staticClass:"line-number"},[n._v("19")]),t("br"),t("span",{staticClass:"line-number"},[n._v("20")]),t("br"),t("span",{staticClass:"line-number"},[n._v("21")]),t("br"),t("span",{staticClass:"line-number"},[n._v("22")]),t("br"),t("span",{staticClass:"line-number"},[n._v("23")]),t("br"),t("span",{staticClass:"line-number"},[n._v("24")]),t("br"),t("span",{staticClass:"line-number"},[n._v("25")]),t("br"),t("span",{staticClass:"line-number"},[n._v("26")]),t("br"),t("span",{staticClass:"line-number"},[n._v("27")]),t("br"),t("span",{staticClass:"line-number"},[n._v("28")]),t("br"),t("span",{staticClass:"line-number"},[n._v("29")]),t("br"),t("span",{staticClass:"line-number"},[n._v("30")]),t("br"),t("span",{staticClass:"line-number"},[n._v("31")]),t("br"),t("span",{staticClass:"line-number"},[n._v("32")]),t("br"),t("span",{staticClass:"line-number"},[n._v("33")]),t("br"),t("span",{staticClass:"line-number"},[n._v("34")]),t("br"),t("span",{staticClass:"line-number"},[n._v("35")]),t("br"),t("span",{staticClass:"line-number"},[n._v("36")]),t("br"),t("span",{staticClass:"line-number"},[n._v("37")]),t("br"),t("span",{staticClass:"line-number"},[n._v("38")]),t("br"),t("span",{staticClass:"line-number"},[n._v("39")]),t("br"),t("span",{staticClass:"line-number"},[n._v("40")]),t("br"),t("span",{staticClass:"line-number"},[n._v("41")]),t("br"),t("span",{staticClass:"line-number"},[n._v("42")]),t("br"),t("span",{staticClass:"line-number"},[n._v("43")]),t("br"),t("span",{staticClass:"line-number"},[n._v("44")]),t("br"),t("span",{staticClass:"line-number"},[n._v("45")]),t("br")])]),t("p",[n._v("ProducerApplication.java")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('import org.springframework.amqp.rabbit.connection.CachingConnectionFactory;\nimport org.springframework.amqp.rabbit.connection.ConnectionFactory;\nimport org.springframework.amqp.rabbit.core.RabbitTemplate;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.EnableAutoConfiguration;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n/**\n * \\* Created with IntelliJ IDEA.\n * \\* User: yufeng\n * \\* Date: 2018/11/22\n * \\* Time: 上午11:25\n * \\* To change this template use File | Settings | File Templates.\n * \\* Description:\n * \\\n */\n@EnableAutoConfiguration\n@Configuration\npublic class ProducerApplication {\n\n    @Autowired\n    private ConnectionFactory connectionFactory;\n\n    @Autowired\n    private RabbitTemplate rabbitTemplate;\n\n    @Bean\n    ConnectionFactory connectionFactory(){\n        CachingConnectionFactory connectionFactory = new CachingConnectionFactory("IP",31105);\n        connectionFactory.setCacheMode(CachingConnectionFactory.CacheMode.CHANNEL);\n        connectionFactory.setChannelCacheSize(100);\n        connectionFactory.setVirtualHost("-dev");\n        connectionFactory.setChannelCheckoutTimeout(10000);\n        connectionFactory.setCloseTimeout(10000);\n        connectionFactory.setConnectionLimit(10000);\n        connectionFactory.setUsername("admin@");\n        connectionFactory.setPassword("admin");\n        return connectionFactory;\n    }\n\n    @Bean\n    public RabbitTemplate rabbitTemplate(){\n        RabbitTemplate rabbitTemplate = new RabbitTemplate(connectionFactory);\n        return rabbitTemplate;\n    }\n\n    public static void main(String[] args) {\n        ApplicationContext context = SpringApplication.run(ProducerApplication.class);\n        RabbitTemplate rabbitTemplate = (RabbitTemplate) context.getBean("rabbitTemplate");\n\n        String message = "{\\"count\\":5,\\"ackmode\\":\\"ack_requeue_true\\",\\"encoding\\":\\"auto\\",\\"truncate\\":50000}";\n        String routingKey = "accounting-initAccount-key";\n        String exchange = "accounting-initAccount-exchange";\n        for (int i=0;i<10;i++){\n            rabbitTemplate.convertAndSend(exchange,routingKey,message);\n        }\n        System.exit(0);\n    }\n}\n')])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br"),t("span",{staticClass:"line-number"},[n._v("13")]),t("br"),t("span",{staticClass:"line-number"},[n._v("14")]),t("br"),t("span",{staticClass:"line-number"},[n._v("15")]),t("br"),t("span",{staticClass:"line-number"},[n._v("16")]),t("br"),t("span",{staticClass:"line-number"},[n._v("17")]),t("br"),t("span",{staticClass:"line-number"},[n._v("18")]),t("br"),t("span",{staticClass:"line-number"},[n._v("19")]),t("br"),t("span",{staticClass:"line-number"},[n._v("20")]),t("br"),t("span",{staticClass:"line-number"},[n._v("21")]),t("br"),t("span",{staticClass:"line-number"},[n._v("22")]),t("br"),t("span",{staticClass:"line-number"},[n._v("23")]),t("br"),t("span",{staticClass:"line-number"},[n._v("24")]),t("br"),t("span",{staticClass:"line-number"},[n._v("25")]),t("br"),t("span",{staticClass:"line-number"},[n._v("26")]),t("br"),t("span",{staticClass:"line-number"},[n._v("27")]),t("br"),t("span",{staticClass:"line-number"},[n._v("28")]),t("br"),t("span",{staticClass:"line-number"},[n._v("29")]),t("br"),t("span",{staticClass:"line-number"},[n._v("30")]),t("br"),t("span",{staticClass:"line-number"},[n._v("31")]),t("br"),t("span",{staticClass:"line-number"},[n._v("32")]),t("br"),t("span",{staticClass:"line-number"},[n._v("33")]),t("br"),t("span",{staticClass:"line-number"},[n._v("34")]),t("br"),t("span",{staticClass:"line-number"},[n._v("35")]),t("br"),t("span",{staticClass:"line-number"},[n._v("36")]),t("br"),t("span",{staticClass:"line-number"},[n._v("37")]),t("br"),t("span",{staticClass:"line-number"},[n._v("38")]),t("br"),t("span",{staticClass:"line-number"},[n._v("39")]),t("br"),t("span",{staticClass:"line-number"},[n._v("40")]),t("br"),t("span",{staticClass:"line-number"},[n._v("41")]),t("br"),t("span",{staticClass:"line-number"},[n._v("42")]),t("br"),t("span",{staticClass:"line-number"},[n._v("43")]),t("br"),t("span",{staticClass:"line-number"},[n._v("44")]),t("br"),t("span",{staticClass:"line-number"},[n._v("45")]),t("br"),t("span",{staticClass:"line-number"},[n._v("46")]),t("br"),t("span",{staticClass:"line-number"},[n._v("47")]),t("br"),t("span",{staticClass:"line-number"},[n._v("48")]),t("br"),t("span",{staticClass:"line-number"},[n._v("49")]),t("br"),t("span",{staticClass:"line-number"},[n._v("50")]),t("br"),t("span",{staticClass:"line-number"},[n._v("51")]),t("br"),t("span",{staticClass:"line-number"},[n._v("52")]),t("br"),t("span",{staticClass:"line-number"},[n._v("53")]),t("br"),t("span",{staticClass:"line-number"},[n._v("54")]),t("br"),t("span",{staticClass:"line-number"},[n._v("55")]),t("br"),t("span",{staticClass:"line-number"},[n._v("56")]),t("br"),t("span",{staticClass:"line-number"},[n._v("57")]),t("br"),t("span",{staticClass:"line-number"},[n._v("58")]),t("br"),t("span",{staticClass:"line-number"},[n._v("59")]),t("br"),t("span",{staticClass:"line-number"},[n._v("60")]),t("br"),t("span",{staticClass:"line-number"},[n._v("61")]),t("br"),t("span",{staticClass:"line-number"},[n._v("62")]),t("br")])]),t("p",[n._v("ConsumerApplication.java")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('import org.springframework.amqp.core.AcknowledgeMode;\nimport org.springframework.amqp.rabbit.annotation.RabbitListener;\nimport org.springframework.amqp.rabbit.config.SimpleRabbitListenerContainerFactory;\nimport org.springframework.amqp.rabbit.connection.CachingConnectionFactory;\nimport org.springframework.amqp.rabbit.connection.ConnectionFactory;\nimport org.springframework.amqp.rabbit.core.RabbitTemplate;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.EnableAutoConfiguration;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.annotation.Bean;\n\n/**\n * \\* Created with IntelliJ IDEA.\n * \\* User: yufeng\n * \\* Date: 2018/11/22\n * \\* Time: 上午11:29\n * \\* To change this template use File | Settings | File Templates.\n * \\* Description:\n * \\\n */\n@EnableAutoConfiguration\npublic class ConsumerApplication {\n\n    @Autowired\n    private ConnectionFactory connectionFactory;\n\n    @Autowired\n    private SimpleRabbitListenerContainerFactory simpleRabbitListenerContainerFactory;\n    @Autowired\n    private RabbitTemplate rabbitTemplate;\n\n    @Bean\n    SimpleRabbitListenerContainerFactory simpleRabbitListenerContainerFactory(){\n        SimpleRabbitListenerContainerFactory simpleRabbitListenerContainerFactory = new SimpleRabbitListenerContainerFactory();\n        simpleRabbitListenerContainerFactory.setConcurrentConsumers(50);\n        simpleRabbitListenerContainerFactory.setMaxConcurrentConsumers(100);\n        simpleRabbitListenerContainerFactory.setConnectionFactory(connectionFactory);\n        simpleRabbitListenerContainerFactory.setAcknowledgeMode(AcknowledgeMode.AUTO);\n        return simpleRabbitListenerContainerFactory;\n    }\n\n\n    @Bean\n    ConnectionFactory connectionFactory(){\n        CachingConnectionFactory connectionFactory = new CachingConnectionFactory("IP",31105);\n        connectionFactory.setCacheMode(CachingConnectionFactory.CacheMode.CHANNEL);\n        connectionFactory.setChannelCacheSize(100);\n        connectionFactory.setVirtualHost("-dev");\n        connectionFactory.setChannelCheckoutTimeout(10000);\n        connectionFactory.setCloseTimeout(10000);\n        connectionFactory.setConnectionLimit(10000);\n        connectionFactory.setUsername("admin@");\n        connectionFactory.setPassword("admin");\n        return connectionFactory;\n    }\n\n//    @RabbitListener(queues = "accounting-initAccount", containerFactory = "simpleRabbitListenerContainerFactory")\n//    public void onMessage(String message){\n//        System.out.printf("message is ->"+message+"\\n");\n//    }\n    @Bean\n    public RabbitTemplate rabbitTemplate(){\n        RabbitTemplate rabbitTemplate = new RabbitTemplate(connectionFactory);\n        return rabbitTemplate;\n    }\n\n    public static void main(String[] args) {\n        ApplicationContext context = SpringApplication.run(ConsumerApplication.class);\n        RabbitTemplate rabbitTemplate = (RabbitTemplate) context.getBean("rabbitTemplate");\n\n        for (int i=0;i<10;i++){\n            rabbitTemplate.receiveAndConvert("accounting-initAccount");\n        }\n        System.exit(0);\n    }\n}\n')])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br"),t("span",{staticClass:"line-number"},[n._v("13")]),t("br"),t("span",{staticClass:"line-number"},[n._v("14")]),t("br"),t("span",{staticClass:"line-number"},[n._v("15")]),t("br"),t("span",{staticClass:"line-number"},[n._v("16")]),t("br"),t("span",{staticClass:"line-number"},[n._v("17")]),t("br"),t("span",{staticClass:"line-number"},[n._v("18")]),t("br"),t("span",{staticClass:"line-number"},[n._v("19")]),t("br"),t("span",{staticClass:"line-number"},[n._v("20")]),t("br"),t("span",{staticClass:"line-number"},[n._v("21")]),t("br"),t("span",{staticClass:"line-number"},[n._v("22")]),t("br"),t("span",{staticClass:"line-number"},[n._v("23")]),t("br"),t("span",{staticClass:"line-number"},[n._v("24")]),t("br"),t("span",{staticClass:"line-number"},[n._v("25")]),t("br"),t("span",{staticClass:"line-number"},[n._v("26")]),t("br"),t("span",{staticClass:"line-number"},[n._v("27")]),t("br"),t("span",{staticClass:"line-number"},[n._v("28")]),t("br"),t("span",{staticClass:"line-number"},[n._v("29")]),t("br"),t("span",{staticClass:"line-number"},[n._v("30")]),t("br"),t("span",{staticClass:"line-number"},[n._v("31")]),t("br"),t("span",{staticClass:"line-number"},[n._v("32")]),t("br"),t("span",{staticClass:"line-number"},[n._v("33")]),t("br"),t("span",{staticClass:"line-number"},[n._v("34")]),t("br"),t("span",{staticClass:"line-number"},[n._v("35")]),t("br"),t("span",{staticClass:"line-number"},[n._v("36")]),t("br"),t("span",{staticClass:"line-number"},[n._v("37")]),t("br"),t("span",{staticClass:"line-number"},[n._v("38")]),t("br"),t("span",{staticClass:"line-number"},[n._v("39")]),t("br"),t("span",{staticClass:"line-number"},[n._v("40")]),t("br"),t("span",{staticClass:"line-number"},[n._v("41")]),t("br"),t("span",{staticClass:"line-number"},[n._v("42")]),t("br"),t("span",{staticClass:"line-number"},[n._v("43")]),t("br"),t("span",{staticClass:"line-number"},[n._v("44")]),t("br"),t("span",{staticClass:"line-number"},[n._v("45")]),t("br"),t("span",{staticClass:"line-number"},[n._v("46")]),t("br"),t("span",{staticClass:"line-number"},[n._v("47")]),t("br"),t("span",{staticClass:"line-number"},[n._v("48")]),t("br"),t("span",{staticClass:"line-number"},[n._v("49")]),t("br"),t("span",{staticClass:"line-number"},[n._v("50")]),t("br"),t("span",{staticClass:"line-number"},[n._v("51")]),t("br"),t("span",{staticClass:"line-number"},[n._v("52")]),t("br"),t("span",{staticClass:"line-number"},[n._v("53")]),t("br"),t("span",{staticClass:"line-number"},[n._v("54")]),t("br"),t("span",{staticClass:"line-number"},[n._v("55")]),t("br"),t("span",{staticClass:"line-number"},[n._v("56")]),t("br"),t("span",{staticClass:"line-number"},[n._v("57")]),t("br"),t("span",{staticClass:"line-number"},[n._v("58")]),t("br"),t("span",{staticClass:"line-number"},[n._v("59")]),t("br"),t("span",{staticClass:"line-number"},[n._v("60")]),t("br"),t("span",{staticClass:"line-number"},[n._v("61")]),t("br"),t("span",{staticClass:"line-number"},[n._v("62")]),t("br"),t("span",{staticClass:"line-number"},[n._v("63")]),t("br"),t("span",{staticClass:"line-number"},[n._v("64")]),t("br"),t("span",{staticClass:"line-number"},[n._v("65")]),t("br"),t("span",{staticClass:"line-number"},[n._v("66")]),t("br"),t("span",{staticClass:"line-number"},[n._v("67")]),t("br"),t("span",{staticClass:"line-number"},[n._v("68")]),t("br"),t("span",{staticClass:"line-number"},[n._v("69")]),t("br"),t("span",{staticClass:"line-number"},[n._v("70")]),t("br"),t("span",{staticClass:"line-number"},[n._v("71")]),t("br"),t("span",{staticClass:"line-number"},[n._v("72")]),t("br"),t("span",{staticClass:"line-number"},[n._v("73")]),t("br"),t("span",{staticClass:"line-number"},[n._v("74")]),t("br"),t("span",{staticClass:"line-number"},[n._v("75")]),t("br"),t("span",{staticClass:"line-number"},[n._v("76")]),t("br"),t("span",{staticClass:"line-number"},[n._v("77")]),t("br")])]),t("h3",{attrs:{id:"打jar包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#打jar包"}},[n._v("#")]),n._v(" 打jar包")]),n._v(" "),t("p",[n._v("pom.xml增加如下配置可以用"),t("code",[n._v("mvn clean build")]),n._v(",来打带依赖的jar包")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <configuration>\n                    <fork>true</fork>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br")])]),t("p",[t("code",[n._v("jar xvf test.jar")]),n._v("命令解压jar包，"),t("code",[n._v("BOOT-INF/lib")]),n._v("目录下即可得到依赖的jar包。")]),n._v(" "),t("h2",{attrs:{id:"java请求编写"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#java请求编写"}},[n._v("#")]),n._v(" java请求编写")]),n._v(" "),t("p",[n._v("新建java工程，复制以上得到的jar包，和jmeter根目录下的lib目录下的jar包，到该java工程lib目录下，并添加依赖。")]),n._v(" "),t("p",[n._v("InitTemplate.java")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('import org.springframework.amqp.rabbit.connection.CachingConnectionFactory;\nimport org.springframework.amqp.rabbit.connection.ConnectionFactory;\nimport org.springframework.amqp.rabbit.core.RabbitTemplate;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.EnableAutoConfiguration;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n/**\n * \\* Created with IntelliJ IDEA.\n * \\* User: yufeng\n * \\* Date: 2018/11/22\n * \\* Time: 上午11:25\n * \\* To change this template use File | Settings | File Templates.\n * \\* Description:\n * \\\n */\n@EnableAutoConfiguration\n@Configuration\npublic class InitTemplate {\n\n\n    @Autowired\n    private  ConnectionFactory connectionFactory;\n\n    @Autowired\n    private  static RabbitTemplate rabbitTemplate;\n\n    private static  ApplicationContext context;\n\n    @Bean\n    ConnectionFactory connectionFactory(){\n        CachingConnectionFactory connectionFactory = new CachingConnectionFactory("IP",31105);\n        connectionFactory.setCacheMode(CachingConnectionFactory.CacheMode.CHANNEL);\n        connectionFactory.setChannelCacheSize(100);\n        connectionFactory.setVirtualHost("-dev");\n        connectionFactory.setChannelCheckoutTimeout(10000);\n        connectionFactory.setCloseTimeout(10000);\n        connectionFactory.setConnectionLimit(10000);\n        connectionFactory.setUsername("admin@");\n        connectionFactory.setPassword("admin");\n        return connectionFactory;\n    }\n\n    @Bean\n    public RabbitTemplate rabbitTemplate(){\n        RabbitTemplate rabbitTemplate = new RabbitTemplate(connectionFactory);\n        return rabbitTemplate;\n    }\n\n    public  static synchronized RabbitTemplate getTemplate(){\n        if(InitTemplate.context == null){\n            InitTemplate.context = SpringApplication.run(InitTemplate.class);\n        }\n        if(InitTemplate.rabbitTemplate == null){\n            InitTemplate.rabbitTemplate = (RabbitTemplate) context.getBean("rabbitTemplate");\n        }\n        return InitTemplate.rabbitTemplate;\n    }\n\n    public static void main(String[] args) {\n//        ApplicationContext context = SpringApplication.run(InitTemplate.class);\n//        RabbitTemplate rabbitTemplate = (RabbitTemplate) context.getBean("rabbitTemplate");\n\n        RabbitTemplate rabbitTemplate = InitTemplate.getTemplate();\n        String message = "{\\"count\\":5,\\"ackmode\\":\\"ack_requeue_true\\",\\"encoding\\":\\"auto\\",\\"truncate\\":50000}";\n        String routingKey = "accounting-initAccount-key";\n        String exchange = "accounting-initAccount-exchange";\n        for (int i=0;i<10;i++){\n            rabbitTemplate.convertAndSend(exchange,routingKey,message);\n//            rabbitTemplate.receiveAndConvert("accounting-initAccount");\n        }\n        System.exit(0);\n    }\n}\n')])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br"),t("span",{staticClass:"line-number"},[n._v("13")]),t("br"),t("span",{staticClass:"line-number"},[n._v("14")]),t("br"),t("span",{staticClass:"line-number"},[n._v("15")]),t("br"),t("span",{staticClass:"line-number"},[n._v("16")]),t("br"),t("span",{staticClass:"line-number"},[n._v("17")]),t("br"),t("span",{staticClass:"line-number"},[n._v("18")]),t("br"),t("span",{staticClass:"line-number"},[n._v("19")]),t("br"),t("span",{staticClass:"line-number"},[n._v("20")]),t("br"),t("span",{staticClass:"line-number"},[n._v("21")]),t("br"),t("span",{staticClass:"line-number"},[n._v("22")]),t("br"),t("span",{staticClass:"line-number"},[n._v("23")]),t("br"),t("span",{staticClass:"line-number"},[n._v("24")]),t("br"),t("span",{staticClass:"line-number"},[n._v("25")]),t("br"),t("span",{staticClass:"line-number"},[n._v("26")]),t("br"),t("span",{staticClass:"line-number"},[n._v("27")]),t("br"),t("span",{staticClass:"line-number"},[n._v("28")]),t("br"),t("span",{staticClass:"line-number"},[n._v("29")]),t("br"),t("span",{staticClass:"line-number"},[n._v("30")]),t("br"),t("span",{staticClass:"line-number"},[n._v("31")]),t("br"),t("span",{staticClass:"line-number"},[n._v("32")]),t("br"),t("span",{staticClass:"line-number"},[n._v("33")]),t("br"),t("span",{staticClass:"line-number"},[n._v("34")]),t("br"),t("span",{staticClass:"line-number"},[n._v("35")]),t("br"),t("span",{staticClass:"line-number"},[n._v("36")]),t("br"),t("span",{staticClass:"line-number"},[n._v("37")]),t("br"),t("span",{staticClass:"line-number"},[n._v("38")]),t("br"),t("span",{staticClass:"line-number"},[n._v("39")]),t("br"),t("span",{staticClass:"line-number"},[n._v("40")]),t("br"),t("span",{staticClass:"line-number"},[n._v("41")]),t("br"),t("span",{staticClass:"line-number"},[n._v("42")]),t("br"),t("span",{staticClass:"line-number"},[n._v("43")]),t("br"),t("span",{staticClass:"line-number"},[n._v("44")]),t("br"),t("span",{staticClass:"line-number"},[n._v("45")]),t("br"),t("span",{staticClass:"line-number"},[n._v("46")]),t("br"),t("span",{staticClass:"line-number"},[n._v("47")]),t("br"),t("span",{staticClass:"line-number"},[n._v("48")]),t("br"),t("span",{staticClass:"line-number"},[n._v("49")]),t("br"),t("span",{staticClass:"line-number"},[n._v("50")]),t("br"),t("span",{staticClass:"line-number"},[n._v("51")]),t("br"),t("span",{staticClass:"line-number"},[n._v("52")]),t("br"),t("span",{staticClass:"line-number"},[n._v("53")]),t("br"),t("span",{staticClass:"line-number"},[n._v("54")]),t("br"),t("span",{staticClass:"line-number"},[n._v("55")]),t("br"),t("span",{staticClass:"line-number"},[n._v("56")]),t("br"),t("span",{staticClass:"line-number"},[n._v("57")]),t("br"),t("span",{staticClass:"line-number"},[n._v("58")]),t("br"),t("span",{staticClass:"line-number"},[n._v("59")]),t("br"),t("span",{staticClass:"line-number"},[n._v("60")]),t("br"),t("span",{staticClass:"line-number"},[n._v("61")]),t("br"),t("span",{staticClass:"line-number"},[n._v("62")]),t("br"),t("span",{staticClass:"line-number"},[n._v("63")]),t("br"),t("span",{staticClass:"line-number"},[n._v("64")]),t("br"),t("span",{staticClass:"line-number"},[n._v("65")]),t("br"),t("span",{staticClass:"line-number"},[n._v("66")]),t("br"),t("span",{staticClass:"line-number"},[n._v("67")]),t("br"),t("span",{staticClass:"line-number"},[n._v("68")]),t("br"),t("span",{staticClass:"line-number"},[n._v("69")]),t("br"),t("span",{staticClass:"line-number"},[n._v("70")]),t("br"),t("span",{staticClass:"line-number"},[n._v("71")]),t("br"),t("span",{staticClass:"line-number"},[n._v("72")]),t("br"),t("span",{staticClass:"line-number"},[n._v("73")]),t("br"),t("span",{staticClass:"line-number"},[n._v("74")]),t("br"),t("span",{staticClass:"line-number"},[n._v("75")]),t("br"),t("span",{staticClass:"line-number"},[n._v("76")]),t("br"),t("span",{staticClass:"line-number"},[n._v("77")]),t("br")])]),t("p",[n._v("JmeterRabbitmqConsumer.java")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('\nimport org.apache.jmeter.config.Arguments;\nimport org.apache.jmeter.protocol.java.sampler.AbstractJavaSamplerClient;\nimport org.apache.jmeter.protocol.java.sampler.JavaSamplerContext;\nimport org.apache.jmeter.samplers.SampleResult;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n\n/**\n * \\* Created with IntelliJ IDEA.\n * \\* User: yufeng\n * \\* Date: 2018/11/22\n * \\* Time: 下午2:03\n * \\* To change this template use File | Settings | File Templates.\n * \\* Description:\n * \\\n */\npublic class JmeterRabbitmqConsumer extends AbstractJavaSamplerClient {\n\n    private static final Logger logger = LoggerFactory.getLogger(JmeterRabbitmqProducer.class);\n\n\n    private String queueName;\n\n    /**\n     * 这个方法是用来自定义java方法入参的\n     * params.addArgument("num1","");表示入参名字叫num1，默认值为空。\n     * @return\n     */\n    @Override\n    public Arguments getDefaultParameters() {\n        Arguments params = new Arguments();\n        params.addArgument("queueName","accounting-initAccount");\n        return params;\n    }\n\n\n    /**\n     * 每个线程测试前执行一次，做一些初始化工作\n     * 获取输入的参数,赋值给变量,参数也可以在下面的runTest方法中获取,这里是为了展示该方法的作用\n     * @param arg0\n     */\n    @Override\n    public void setupTest(JavaSamplerContext arg0) {\n        queueName = arg0.getParameter("queueName");\n    }\n\n\n    /**\n     * 真正执行逻辑的方法\n     * @param arg0\n     * @return\n     */\n    @Override\n    public SampleResult runTest(JavaSamplerContext arg0) {\n        SampleResult sr = new SampleResult();\n\n        sr.setResponseData("消费消息;","utf-8");\n\n        logger.info("消费消息!!!");\n\n\n        try {\n            // jmeter 开始统计响应时间标记\n            sr.sampleStart();\n\n            InitTemplate.getTemplate().receiveAndConvert(queueName);\n\n\n            // 通过下面的操作就可以将被测方法的响应输出到Jmeter的察看结果树中的响应数据里面了。\n            sr.setResponseData("结果是：消费消息成功", "utf-8");\n            logger.info("消费消息结束!!!");\n            sr.setDataType(SampleResult.TEXT);\n\n\n            //设置响应执行成功\n            sr.setSuccessful(true);\n        } catch (Throwable e) {\n            //有异常,执行失败\n            sr.setSuccessful(false);\n            e.printStackTrace();\n        } finally {\n            // jmeter 结束统计响应时间标记\n            sr.sampleEnd();\n        }\n        return sr;\n    }\n\n\n\n\n    /**\n     * 测试结束后调用\n     * @param arg0\n     */\n    @Override\n    public void teardownTest(JavaSamplerContext arg0) {\n\n\n    }\n\n\n    /**\n     * main方法测试程序是否可用,打包时 注释掉\n     * @param args\n     */\n\n    public static void main(String[] args) {\n//        ApplicationContext context = SpringApplication.run(ConsumerApplication.class);\n//        RabbitTemplate rabbitTemplate = (RabbitTemplate) context.getBean("rabbitTemplate");\n//\n//        for (int i=0;i<10;i++){\n//            rabbitTemplate.receiveAndConvert("accounting-initAccount");\n//        }\n//        System.exit(0);\n\n//        测试\n        Arguments params = new Arguments();\n        params.addArgument("queueName","accounting-initAccount");\n        JavaSamplerContext arg0 = new JavaSamplerContext(params);\n        JmeterRabbitmqConsumer test = new JmeterRabbitmqConsumer();\n        test.setupTest(arg0);\n        test.runTest(arg0);\n        test.teardownTest(arg0);\n        System.exit(0);\n\n    }\n}\n')])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br"),t("span",{staticClass:"line-number"},[n._v("13")]),t("br"),t("span",{staticClass:"line-number"},[n._v("14")]),t("br"),t("span",{staticClass:"line-number"},[n._v("15")]),t("br"),t("span",{staticClass:"line-number"},[n._v("16")]),t("br"),t("span",{staticClass:"line-number"},[n._v("17")]),t("br"),t("span",{staticClass:"line-number"},[n._v("18")]),t("br"),t("span",{staticClass:"line-number"},[n._v("19")]),t("br"),t("span",{staticClass:"line-number"},[n._v("20")]),t("br"),t("span",{staticClass:"line-number"},[n._v("21")]),t("br"),t("span",{staticClass:"line-number"},[n._v("22")]),t("br"),t("span",{staticClass:"line-number"},[n._v("23")]),t("br"),t("span",{staticClass:"line-number"},[n._v("24")]),t("br"),t("span",{staticClass:"line-number"},[n._v("25")]),t("br"),t("span",{staticClass:"line-number"},[n._v("26")]),t("br"),t("span",{staticClass:"line-number"},[n._v("27")]),t("br"),t("span",{staticClass:"line-number"},[n._v("28")]),t("br"),t("span",{staticClass:"line-number"},[n._v("29")]),t("br"),t("span",{staticClass:"line-number"},[n._v("30")]),t("br"),t("span",{staticClass:"line-number"},[n._v("31")]),t("br"),t("span",{staticClass:"line-number"},[n._v("32")]),t("br"),t("span",{staticClass:"line-number"},[n._v("33")]),t("br"),t("span",{staticClass:"line-number"},[n._v("34")]),t("br"),t("span",{staticClass:"line-number"},[n._v("35")]),t("br"),t("span",{staticClass:"line-number"},[n._v("36")]),t("br"),t("span",{staticClass:"line-number"},[n._v("37")]),t("br"),t("span",{staticClass:"line-number"},[n._v("38")]),t("br"),t("span",{staticClass:"line-number"},[n._v("39")]),t("br"),t("span",{staticClass:"line-number"},[n._v("40")]),t("br"),t("span",{staticClass:"line-number"},[n._v("41")]),t("br"),t("span",{staticClass:"line-number"},[n._v("42")]),t("br"),t("span",{staticClass:"line-number"},[n._v("43")]),t("br"),t("span",{staticClass:"line-number"},[n._v("44")]),t("br"),t("span",{staticClass:"line-number"},[n._v("45")]),t("br"),t("span",{staticClass:"line-number"},[n._v("46")]),t("br"),t("span",{staticClass:"line-number"},[n._v("47")]),t("br"),t("span",{staticClass:"line-number"},[n._v("48")]),t("br"),t("span",{staticClass:"line-number"},[n._v("49")]),t("br"),t("span",{staticClass:"line-number"},[n._v("50")]),t("br"),t("span",{staticClass:"line-number"},[n._v("51")]),t("br"),t("span",{staticClass:"line-number"},[n._v("52")]),t("br"),t("span",{staticClass:"line-number"},[n._v("53")]),t("br"),t("span",{staticClass:"line-number"},[n._v("54")]),t("br"),t("span",{staticClass:"line-number"},[n._v("55")]),t("br"),t("span",{staticClass:"line-number"},[n._v("56")]),t("br"),t("span",{staticClass:"line-number"},[n._v("57")]),t("br"),t("span",{staticClass:"line-number"},[n._v("58")]),t("br"),t("span",{staticClass:"line-number"},[n._v("59")]),t("br"),t("span",{staticClass:"line-number"},[n._v("60")]),t("br"),t("span",{staticClass:"line-number"},[n._v("61")]),t("br"),t("span",{staticClass:"line-number"},[n._v("62")]),t("br"),t("span",{staticClass:"line-number"},[n._v("63")]),t("br"),t("span",{staticClass:"line-number"},[n._v("64")]),t("br"),t("span",{staticClass:"line-number"},[n._v("65")]),t("br"),t("span",{staticClass:"line-number"},[n._v("66")]),t("br"),t("span",{staticClass:"line-number"},[n._v("67")]),t("br"),t("span",{staticClass:"line-number"},[n._v("68")]),t("br"),t("span",{staticClass:"line-number"},[n._v("69")]),t("br"),t("span",{staticClass:"line-number"},[n._v("70")]),t("br"),t("span",{staticClass:"line-number"},[n._v("71")]),t("br"),t("span",{staticClass:"line-number"},[n._v("72")]),t("br"),t("span",{staticClass:"line-number"},[n._v("73")]),t("br"),t("span",{staticClass:"line-number"},[n._v("74")]),t("br"),t("span",{staticClass:"line-number"},[n._v("75")]),t("br"),t("span",{staticClass:"line-number"},[n._v("76")]),t("br"),t("span",{staticClass:"line-number"},[n._v("77")]),t("br"),t("span",{staticClass:"line-number"},[n._v("78")]),t("br"),t("span",{staticClass:"line-number"},[n._v("79")]),t("br"),t("span",{staticClass:"line-number"},[n._v("80")]),t("br"),t("span",{staticClass:"line-number"},[n._v("81")]),t("br"),t("span",{staticClass:"line-number"},[n._v("82")]),t("br"),t("span",{staticClass:"line-number"},[n._v("83")]),t("br"),t("span",{staticClass:"line-number"},[n._v("84")]),t("br"),t("span",{staticClass:"line-number"},[n._v("85")]),t("br"),t("span",{staticClass:"line-number"},[n._v("86")]),t("br"),t("span",{staticClass:"line-number"},[n._v("87")]),t("br"),t("span",{staticClass:"line-number"},[n._v("88")]),t("br"),t("span",{staticClass:"line-number"},[n._v("89")]),t("br"),t("span",{staticClass:"line-number"},[n._v("90")]),t("br"),t("span",{staticClass:"line-number"},[n._v("91")]),t("br"),t("span",{staticClass:"line-number"},[n._v("92")]),t("br"),t("span",{staticClass:"line-number"},[n._v("93")]),t("br"),t("span",{staticClass:"line-number"},[n._v("94")]),t("br"),t("span",{staticClass:"line-number"},[n._v("95")]),t("br"),t("span",{staticClass:"line-number"},[n._v("96")]),t("br"),t("span",{staticClass:"line-number"},[n._v("97")]),t("br"),t("span",{staticClass:"line-number"},[n._v("98")]),t("br"),t("span",{staticClass:"line-number"},[n._v("99")]),t("br"),t("span",{staticClass:"line-number"},[n._v("100")]),t("br"),t("span",{staticClass:"line-number"},[n._v("101")]),t("br"),t("span",{staticClass:"line-number"},[n._v("102")]),t("br"),t("span",{staticClass:"line-number"},[n._v("103")]),t("br"),t("span",{staticClass:"line-number"},[n._v("104")]),t("br"),t("span",{staticClass:"line-number"},[n._v("105")]),t("br"),t("span",{staticClass:"line-number"},[n._v("106")]),t("br"),t("span",{staticClass:"line-number"},[n._v("107")]),t("br"),t("span",{staticClass:"line-number"},[n._v("108")]),t("br"),t("span",{staticClass:"line-number"},[n._v("109")]),t("br"),t("span",{staticClass:"line-number"},[n._v("110")]),t("br"),t("span",{staticClass:"line-number"},[n._v("111")]),t("br"),t("span",{staticClass:"line-number"},[n._v("112")]),t("br"),t("span",{staticClass:"line-number"},[n._v("113")]),t("br"),t("span",{staticClass:"line-number"},[n._v("114")]),t("br"),t("span",{staticClass:"line-number"},[n._v("115")]),t("br"),t("span",{staticClass:"line-number"},[n._v("116")]),t("br"),t("span",{staticClass:"line-number"},[n._v("117")]),t("br"),t("span",{staticClass:"line-number"},[n._v("118")]),t("br"),t("span",{staticClass:"line-number"},[n._v("119")]),t("br"),t("span",{staticClass:"line-number"},[n._v("120")]),t("br"),t("span",{staticClass:"line-number"},[n._v("121")]),t("br"),t("span",{staticClass:"line-number"},[n._v("122")]),t("br"),t("span",{staticClass:"line-number"},[n._v("123")]),t("br"),t("span",{staticClass:"line-number"},[n._v("124")]),t("br"),t("span",{staticClass:"line-number"},[n._v("125")]),t("br"),t("span",{staticClass:"line-number"},[n._v("126")]),t("br"),t("span",{staticClass:"line-number"},[n._v("127")]),t("br"),t("span",{staticClass:"line-number"},[n._v("128")]),t("br"),t("span",{staticClass:"line-number"},[n._v("129")]),t("br"),t("span",{staticClass:"line-number"},[n._v("130")]),t("br")])]),t("p",[n._v("JmeterRabbitmqProducer.java")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('import jodd.log.Logger;\nimport jodd.log.LoggerFactory;\nimport org.apache.jmeter.config.Arguments;\nimport org.apache.jmeter.protocol.java.sampler.AbstractJavaSamplerClient;\nimport org.apache.jmeter.protocol.java.sampler.JavaSamplerContext;\nimport org.apache.jmeter.samplers.SampleResult;\n\n\n/**\n * \\* Created with IntelliJ IDEA.\n * \\* User: yufeng\n * \\* Date: 2018/11/22\n * \\* Time: 下午1:45\n * \\* To change this template use File | Settings | File Templates.\n * \\* Description:\n * \\\n */\npublic class JmeterRabbitmqProducer  extends AbstractJavaSamplerClient {\n\n    private static final Logger logger = LoggerFactory.getLogger(JmeterRabbitmqConsumer.class);\n\n\n\n    private String message ;\n    private String routingKey;\n    private String exchange;\n\n    /**\n     * 这个方法是用来自定义java方法入参的\n     * params.addArgument("num1","");表示入参名字叫num1，默认值为空。\n     * @return\n     */\n    @Override\n    public Arguments getDefaultParameters() {\n        Arguments params = new Arguments();\n//        params.addArgument("message","{\\"count\\":5,\\"ackmode\\":\\"ack_requeue_true\\",\\"encoding\\":\\"auto\\",\\"truncate\\":50000}");\n        params.addArgument("routingKey","accounting-initAccount-key");\n        params.addArgument("exchange","accounting-initAccount-exchange");\n\n        return params;\n    }\n\n\n    /**\n     * 每个线程测试前执行一次，做一些初始化工作\n     * 获取输入的参数,赋值给变量,参数也可以在下面的runTest方法中获取,这里是为了展示该方法的作用\n     * @param arg0\n     */\n    @Override\n    public void setupTest(JavaSamplerContext arg0) {\n//        message = arg0.getParameter("message");\n        routingKey = arg0.getParameter("routingKey");\n        exchange = arg0.getParameter("exchange");\n    }\n\n\n    /**\n     * 真正执行逻辑的方法\n     * @param arg0\n     * @return\n     */\n    @Override\n    public SampleResult runTest(JavaSamplerContext arg0) {\n        SampleResult sr = new SampleResult();\n\n        sr.setResponseData("生产消息;","utf-8");\n\n        logger.info("生产消息!!!");\n\n\n        try {\n            // jmeter 开始统计响应时间标记\n            sr.sampleStart();\n\n            InitTemplate.getTemplate().convertAndSend(exchange,routingKey,"{\\"count\\":5,\\"ackmode\\":\\"ack_requeue_true\\",\\"encoding\\":\\"auto\\",\\"truncate\\":50000}");\n\n\n            // 通过下面的操作就可以将被测方法的响应输出到Jmeter的察看结果树中的响应数据里面了。\n            sr.setResponseData("结果是：生产消息成功", "utf-8");\n            logger.info("生产消息结束!!!");\n            sr.setDataType(SampleResult.TEXT);\n\n\n            //设置响应执行成功\n            sr.setSuccessful(true);\n        } catch (Throwable e) {\n            //有异常,执行失败\n            sr.setSuccessful(false);\n            e.printStackTrace();\n        } finally {\n            // jmeter 结束统计响应时间标记\n            sr.sampleEnd();\n        }\n        return sr;\n    }\n\n\n\n\n    /**\n     * 测试结束后调用\n     * @param arg0\n     */\n    @Override\n    public void teardownTest(JavaSamplerContext arg0) {\n\n\n    }\n\n\n    /**\n     * main方法测试程序是否可用,打包时 注释掉\n     * @param args\n     */\n\n    public static void main(String[] args) {\n//        ApplicationContext context = SpringApplication.run(ProducerApplication.class);\n//        RabbitTemplate rabbitTemplate = (RabbitTemplate) context.getBean("rabbitTemplate");\n//\n//        String message = "{\\"count\\":5,\\"ackmode\\":\\"ack_requeue_true\\",\\"encoding\\":\\"auto\\",\\"truncate\\":50000}";\n//        String routingKey = "accounting-initAccount-key";\n//        String exchange = "accounting-initAccount-exchange";\n//        for (int i=0;i<10;i++){\n//            rabbitTemplate.convertAndSend(exchange,routingKey,message);\n//        }\n//        System.exit(0);\n\n//        测试\n        Arguments params = new Arguments();\n//        params.addArgument("message","{\\"count\\":5,\\"ackmode\\":\\"ack_requeue_true\\",\\"encoding\\":\\"auto\\",\\"truncate\\":50000}");\n        params.addArgument("routingKey","accounting-initAccount-key");\n        params.addArgument("exchange","accounting-initAccount-exchange");\n        JavaSamplerContext arg0 = new JavaSamplerContext(params);\n        JmeterRabbitmqProducer test = new JmeterRabbitmqProducer();\n        test.setupTest(arg0);\n        test.runTest(arg0);\n        test.teardownTest(arg0);\n        System.exit(0);\n    }\n\n\n}\n')])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br"),t("span",{staticClass:"line-number"},[n._v("13")]),t("br"),t("span",{staticClass:"line-number"},[n._v("14")]),t("br"),t("span",{staticClass:"line-number"},[n._v("15")]),t("br"),t("span",{staticClass:"line-number"},[n._v("16")]),t("br"),t("span",{staticClass:"line-number"},[n._v("17")]),t("br"),t("span",{staticClass:"line-number"},[n._v("18")]),t("br"),t("span",{staticClass:"line-number"},[n._v("19")]),t("br"),t("span",{staticClass:"line-number"},[n._v("20")]),t("br"),t("span",{staticClass:"line-number"},[n._v("21")]),t("br"),t("span",{staticClass:"line-number"},[n._v("22")]),t("br"),t("span",{staticClass:"line-number"},[n._v("23")]),t("br"),t("span",{staticClass:"line-number"},[n._v("24")]),t("br"),t("span",{staticClass:"line-number"},[n._v("25")]),t("br"),t("span",{staticClass:"line-number"},[n._v("26")]),t("br"),t("span",{staticClass:"line-number"},[n._v("27")]),t("br"),t("span",{staticClass:"line-number"},[n._v("28")]),t("br"),t("span",{staticClass:"line-number"},[n._v("29")]),t("br"),t("span",{staticClass:"line-number"},[n._v("30")]),t("br"),t("span",{staticClass:"line-number"},[n._v("31")]),t("br"),t("span",{staticClass:"line-number"},[n._v("32")]),t("br"),t("span",{staticClass:"line-number"},[n._v("33")]),t("br"),t("span",{staticClass:"line-number"},[n._v("34")]),t("br"),t("span",{staticClass:"line-number"},[n._v("35")]),t("br"),t("span",{staticClass:"line-number"},[n._v("36")]),t("br"),t("span",{staticClass:"line-number"},[n._v("37")]),t("br"),t("span",{staticClass:"line-number"},[n._v("38")]),t("br"),t("span",{staticClass:"line-number"},[n._v("39")]),t("br"),t("span",{staticClass:"line-number"},[n._v("40")]),t("br"),t("span",{staticClass:"line-number"},[n._v("41")]),t("br"),t("span",{staticClass:"line-number"},[n._v("42")]),t("br"),t("span",{staticClass:"line-number"},[n._v("43")]),t("br"),t("span",{staticClass:"line-number"},[n._v("44")]),t("br"),t("span",{staticClass:"line-number"},[n._v("45")]),t("br"),t("span",{staticClass:"line-number"},[n._v("46")]),t("br"),t("span",{staticClass:"line-number"},[n._v("47")]),t("br"),t("span",{staticClass:"line-number"},[n._v("48")]),t("br"),t("span",{staticClass:"line-number"},[n._v("49")]),t("br"),t("span",{staticClass:"line-number"},[n._v("50")]),t("br"),t("span",{staticClass:"line-number"},[n._v("51")]),t("br"),t("span",{staticClass:"line-number"},[n._v("52")]),t("br"),t("span",{staticClass:"line-number"},[n._v("53")]),t("br"),t("span",{staticClass:"line-number"},[n._v("54")]),t("br"),t("span",{staticClass:"line-number"},[n._v("55")]),t("br"),t("span",{staticClass:"line-number"},[n._v("56")]),t("br"),t("span",{staticClass:"line-number"},[n._v("57")]),t("br"),t("span",{staticClass:"line-number"},[n._v("58")]),t("br"),t("span",{staticClass:"line-number"},[n._v("59")]),t("br"),t("span",{staticClass:"line-number"},[n._v("60")]),t("br"),t("span",{staticClass:"line-number"},[n._v("61")]),t("br"),t("span",{staticClass:"line-number"},[n._v("62")]),t("br"),t("span",{staticClass:"line-number"},[n._v("63")]),t("br"),t("span",{staticClass:"line-number"},[n._v("64")]),t("br"),t("span",{staticClass:"line-number"},[n._v("65")]),t("br"),t("span",{staticClass:"line-number"},[n._v("66")]),t("br"),t("span",{staticClass:"line-number"},[n._v("67")]),t("br"),t("span",{staticClass:"line-number"},[n._v("68")]),t("br"),t("span",{staticClass:"line-number"},[n._v("69")]),t("br"),t("span",{staticClass:"line-number"},[n._v("70")]),t("br"),t("span",{staticClass:"line-number"},[n._v("71")]),t("br"),t("span",{staticClass:"line-number"},[n._v("72")]),t("br"),t("span",{staticClass:"line-number"},[n._v("73")]),t("br"),t("span",{staticClass:"line-number"},[n._v("74")]),t("br"),t("span",{staticClass:"line-number"},[n._v("75")]),t("br"),t("span",{staticClass:"line-number"},[n._v("76")]),t("br"),t("span",{staticClass:"line-number"},[n._v("77")]),t("br"),t("span",{staticClass:"line-number"},[n._v("78")]),t("br"),t("span",{staticClass:"line-number"},[n._v("79")]),t("br"),t("span",{staticClass:"line-number"},[n._v("80")]),t("br"),t("span",{staticClass:"line-number"},[n._v("81")]),t("br"),t("span",{staticClass:"line-number"},[n._v("82")]),t("br"),t("span",{staticClass:"line-number"},[n._v("83")]),t("br"),t("span",{staticClass:"line-number"},[n._v("84")]),t("br"),t("span",{staticClass:"line-number"},[n._v("85")]),t("br"),t("span",{staticClass:"line-number"},[n._v("86")]),t("br"),t("span",{staticClass:"line-number"},[n._v("87")]),t("br"),t("span",{staticClass:"line-number"},[n._v("88")]),t("br"),t("span",{staticClass:"line-number"},[n._v("89")]),t("br"),t("span",{staticClass:"line-number"},[n._v("90")]),t("br"),t("span",{staticClass:"line-number"},[n._v("91")]),t("br"),t("span",{staticClass:"line-number"},[n._v("92")]),t("br"),t("span",{staticClass:"line-number"},[n._v("93")]),t("br"),t("span",{staticClass:"line-number"},[n._v("94")]),t("br"),t("span",{staticClass:"line-number"},[n._v("95")]),t("br"),t("span",{staticClass:"line-number"},[n._v("96")]),t("br"),t("span",{staticClass:"line-number"},[n._v("97")]),t("br"),t("span",{staticClass:"line-number"},[n._v("98")]),t("br"),t("span",{staticClass:"line-number"},[n._v("99")]),t("br"),t("span",{staticClass:"line-number"},[n._v("100")]),t("br"),t("span",{staticClass:"line-number"},[n._v("101")]),t("br"),t("span",{staticClass:"line-number"},[n._v("102")]),t("br"),t("span",{staticClass:"line-number"},[n._v("103")]),t("br"),t("span",{staticClass:"line-number"},[n._v("104")]),t("br"),t("span",{staticClass:"line-number"},[n._v("105")]),t("br"),t("span",{staticClass:"line-number"},[n._v("106")]),t("br"),t("span",{staticClass:"line-number"},[n._v("107")]),t("br"),t("span",{staticClass:"line-number"},[n._v("108")]),t("br"),t("span",{staticClass:"line-number"},[n._v("109")]),t("br"),t("span",{staticClass:"line-number"},[n._v("110")]),t("br"),t("span",{staticClass:"line-number"},[n._v("111")]),t("br"),t("span",{staticClass:"line-number"},[n._v("112")]),t("br"),t("span",{staticClass:"line-number"},[n._v("113")]),t("br"),t("span",{staticClass:"line-number"},[n._v("114")]),t("br"),t("span",{staticClass:"line-number"},[n._v("115")]),t("br"),t("span",{staticClass:"line-number"},[n._v("116")]),t("br"),t("span",{staticClass:"line-number"},[n._v("117")]),t("br"),t("span",{staticClass:"line-number"},[n._v("118")]),t("br"),t("span",{staticClass:"line-number"},[n._v("119")]),t("br"),t("span",{staticClass:"line-number"},[n._v("120")]),t("br"),t("span",{staticClass:"line-number"},[n._v("121")]),t("br"),t("span",{staticClass:"line-number"},[n._v("122")]),t("br"),t("span",{staticClass:"line-number"},[n._v("123")]),t("br"),t("span",{staticClass:"line-number"},[n._v("124")]),t("br"),t("span",{staticClass:"line-number"},[n._v("125")]),t("br"),t("span",{staticClass:"line-number"},[n._v("126")]),t("br"),t("span",{staticClass:"line-number"},[n._v("127")]),t("br"),t("span",{staticClass:"line-number"},[n._v("128")]),t("br"),t("span",{staticClass:"line-number"},[n._v("129")]),t("br"),t("span",{staticClass:"line-number"},[n._v("130")]),t("br"),t("span",{staticClass:"line-number"},[n._v("131")]),t("br"),t("span",{staticClass:"line-number"},[n._v("132")]),t("br"),t("span",{staticClass:"line-number"},[n._v("133")]),t("br"),t("span",{staticClass:"line-number"},[n._v("134")]),t("br"),t("span",{staticClass:"line-number"},[n._v("135")]),t("br"),t("span",{staticClass:"line-number"},[n._v("136")]),t("br"),t("span",{staticClass:"line-number"},[n._v("137")]),t("br"),t("span",{staticClass:"line-number"},[n._v("138")]),t("br"),t("span",{staticClass:"line-number"},[n._v("139")]),t("br"),t("span",{staticClass:"line-number"},[n._v("140")]),t("br"),t("span",{staticClass:"line-number"},[n._v("141")]),t("br"),t("span",{staticClass:"line-number"},[n._v("142")]),t("br")])]),t("h2",{attrs:{id:"打jar包-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#打jar包-2"}},[n._v("#")]),n._v(" 打jar包")]),n._v(" "),t("p",[t("strong",[n._v("创建一个java普通工程")])]),n._v(" "),t("p",[n._v("1.点击Project创建一个Module\n"),t("img",{attrs:{src:a(549),alt:"1"}})]),n._v(" "),t("p",[n._v("2.选择jdk,选择javaEE,点击next")]),n._v(" "),t("p",[t("img",{attrs:{src:a(550),alt:"2"}})]),n._v(" "),t("p",[n._v("3.输入项目名,点击Finish")]),n._v(" "),t("p",[t("img",{attrs:{src:a(551),alt:"3"}})]),n._v(" "),t("p",[t("strong",[n._v("添加依赖jar包")])]),n._v(" "),t("p",[n._v("1.点击File ->Project Structure...")]),n._v(" "),t("p",[t("img",{attrs:{src:a(552),alt:""}})]),n._v(" "),t("p",[n._v("2.选择jar包,确认就可以了")]),n._v(" "),t("p",[t("img",{attrs:{src:a(553),alt:""}})]),n._v(" "),t("p",[t("strong",[n._v("将程序打成jar包")])]),n._v(" "),t("p",[n._v("1.点击File ->Project Structure...->Artifacts")]),n._v(" "),t("p",[t("img",{attrs:{src:a(554),alt:""}})]),n._v(" "),t("p",[n._v("2.选择要打包的程序")]),n._v(" "),t("p",[t("img",{attrs:{src:a(555),alt:""}}),n._v(" "),t("img",{attrs:{src:a(556),alt:""}})]),n._v(" "),t("p",[n._v("3.打包程序 Build ->Build Artifacts...")]),n._v(" "),t("p",[t("img",{attrs:{src:a(557),alt:""}})]),n._v(" "),t("p",[n._v("4.点击屏幕中间出现的那个小框就可以了")]),n._v(" "),t("p",[t("img",{attrs:{src:a(558),alt:""}})]),n._v(" "),t("blockquote",[t("p",[n._v("参考")]),n._v(" "),t("blockquote",[t("p",[n._v("https://blog.csdn.net/qq_34021712/article/details/78871739")])])]),n._v(" "),t("h2",{attrs:{id:"jmeter运行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jmeter运行"}},[n._v("#")]),n._v(" jmeter运行")]),n._v(" "),t("p",[n._v("复制springboot的依赖jar包，复制java工程打的jar包，然后放在jmeter_home/lib/ext下面。然后就可以添加java请求了")]),n._v(" "),t("p",[n._v("Backend Listener\n"),t("img",{attrs:{src:a(559),alt:""}})]),n._v(" "),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[n._v("#")]),n._v(" 总结")]),n._v(" "),t("p",[n._v("实际上很多java项目都是基于springboot来完成，结合springboot的代码来完成jmeter的java请求，对于解决很多问题都有借鉴意义。")]),n._v(" "),t("p",[n._v("rabbitmq服务是其它服务通过rpc来链接的，采用http的方式不能模拟这种场景下的压力状况。通过java请求，对ApplicationContext、RabbitTemplate进行单例、并对InitTemplate.getTemplate()静态方法加锁，可以复用连接，可以完成压测脚本的编写。")]),n._v(" "),t("h2",{attrs:{id:"jar压缩和解压"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jar压缩和解压"}},[n._v("#")]),n._v(" jar压缩和解压")]),n._v(" "),t("ol",[t("li",[t("p",[n._v("压缩包：\njar cvf filename.jar a.class b.class: 压缩指定文件；\njar cvf weibosdkcore.jar *: 全部压缩；")])]),n._v(" "),t("li",[t("p",[n._v("解压包：\njar xvf test.jar")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);